<div class="container-fluid">
  <div class="row mb-4">
    <div class="col-12">
      <h2 class="fw-bold">لوحة تحكم الأدمن</h2>
      <p class="text-muted">مرحباً بك في لوحة تحكم منصة سمسارك. يمكنك إدارة كل شيء من هنا.</p>
    </div>
  </div>

  <!-- Tabs for Users/Properties -->
  <ul class="nav nav-tabs mb-3">
    <li class="nav-item">
      <a class="nav-link" [class.active]="activeTab === 'users'" (click)="onTabChange('users')">
        <i class="bi bi-people"></i> المستخدمين
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" [class.active]="activeTab === 'properties'" (click)="onTabChange('properties')">
        <i class="bi bi-building"></i> العقارات
      </a>
    </li>
  </ul>

  <div [hidden]="activeTab !== 'users'">
    <div *ngIf="loading" class="alert alert-info"><i class="bi bi-arrow-repeat"></i> جاري تحميل المستخدمين...</div>
    <div *ngIf="error && !loading" class="alert alert-danger">{{ error }}</div>
    <div *ngIf="!loading && !error">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>اسم المستخدم</th>
            <th>البريد الإلكتروني</th>
            <th>الدور</th>
            <th>تفاصيل</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of users; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ user.userName || user.username }}</td>
            <td>{{ user.email }}</td>
            <td>
              <span *ngIf="user.roles && user.roles.length; else singleRole">
                <span *ngFor="let role of user.roles; let last = last">
                  <span class="badge bg-info text-dark">{{ role }}</span><span *ngIf="!last">, </span>
                </span>
              </span>
              <ng-template #singleRole>
                <span class="badge bg-info text-dark">{{ user.role }}</span>
              </ng-template>
            </td>
            <td>
              <a [routerLink]="['/admin/users', user.id]" class="btn btn-sm btn-outline-primary">تفاصيل</a>
            </td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="users.length === 0" class="alert alert-warning">لا يوجد مستخدمين.</div>
    </div>
  </div>

  <div [hidden]="activeTab !== 'properties'">
    <div *ngIf="propertiesLoading" class="alert alert-info"><i class="bi bi-arrow-repeat"></i> جاري تحميل العقارات...</div>
    <div *ngIf="propertiesError && !propertiesLoading" class="alert alert-danger">{{ propertiesError }}</div>
    <div *ngIf="!propertiesLoading && !propertiesError">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>العنوان</th>
            <th>المدينة</th>
            <th>المنطقة</th>
            <th>الحالة</th>
            <th>المالك</th>
            <th>تفاصيل</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let property of properties; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ property.title }}</td>
            <td>{{ property.city }}</td>
            <td>{{ property.region }}</td>
            <td><span class="badge bg-info text-dark">{{ property.status }}</span></td>
            <td>{{ property.owner?.userName || property.owner?.username || property.owner?.UserName }}</td>
            <td>
              <a [routerLink]="['/admin/properties', property.id]" class="btn btn-sm btn-outline-primary">عرض</a>
            </td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="properties.length === 0" class="alert alert-warning">لا يوجد عقارات.</div>
    </div>
  </div>
</div> 